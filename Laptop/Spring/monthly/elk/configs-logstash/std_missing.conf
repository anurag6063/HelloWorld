input {

    # loads data from given email message table; includes all rma changes

## title
## type
## updateddatetime
## source
## tags -> sorce, level 0 put anything.
## dynamin case no in url

# jdbc streaming - 7 written, 1 disabled for comments, 1 contains 2 tables. 6 streaming - 7 tables
    jdbc {
        jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
        jdbc_user => "TLDLIC"
        jdbc_password => "TldLicspDev123"
        jdbc_validate_connection => true
        jdbc_driver_library => "./ojdbc6.jar"
        jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
        statement => "select distinct a.casenumber , concat('https://casupport-qa.broadcom.com/case/archived-symantec?source=sym_case_arch_alias&id=',a.casenumber) AS url from TLDLIC.ES_2_STD_CASENUMBER_SUB_DESC A where casenumber !=  'CASENUMBER' order by casenumber desc"

         add_field => {
                        "source" => "Symantec Case Archive"
                        "type" => "Standard Archival Case"
                }
    #    add_tag => ["ESEARCH_2_STD_CASE_ALL"]
         tags => [  "ESEARCH_2_STD_CASE_SUB_DESC" , "ESEARCH_2_STD_CASE_HISTORY_ALL"
         , "ESEARCH_2_STD_CASE_NOTES","ESEARCH_2_STD_CASE_DEFECTS" ,"ESEARCH_2_STD_CASE_COMMENTS" , "ESEARCH_2_STD_CASE_ETRACK" , "MAR_09"]
    }
}
filter {

                jdbc_streaming {
                        jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
                        jdbc_user => "TLDLIC"
                        jdbc_password => "TldLicspDev123"
                        jdbc_validate_connection => true
                        jdbc_driver_library => "./ojdbc6.jar"
                        jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
            #not exists ESEARCH_2_STD_CASE_ALL
            statement => "select * from ESEARCH_2_STD_CASE_ALL A inner join ESEARCH_2_STD_CASE_SUB_DESC B on a.casenumber = b.casenumber where a.casenumber= :bythis9"

            target => "case_details"
                        parameters => { "bythis9" => "casenumber"}
            cache_size => 10000
            tag_on_default_use => ["no_records_found_ESEARCH_2_STD_CASE_ALL"]
            tag_on_failure => ["failure_occured_table_ESEARCH_2_STD_CASE_ALL"]



        }


 jdbc_streaming {

        jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
        jdbc_user => "TLDLIC"
        jdbc_password => "TldLicspDev123"
        jdbc_validate_connection => true
        jdbc_driver_library => "./ojdbc6.jar"
        jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
        # not exists
        statement => "select * from ESEARCH_2_STD_CASE_HISTORY_ALL  where casenumber = :bythis2"
        parameters => { "bythis2" => "casenumber"}
        target => "case_history"

        cache_size => 10000
        tag_on_default_use => ["no_records_found_ESEARCH_2_STD_CASE_HISTORY_ALL"]
        tag_on_failure => ["failure_occured_table_ESEARCH_2_STD_CASE_HISTORY_ALL"]

 }

 jdbc_streaming {

        jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
        jdbc_user => "TLDLIC"
        jdbc_password => "TldLicspDev123"
        jdbc_validate_connection => true
        jdbc_driver_library => "./ojdbc6.jar"
        jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
        statement => "select * from ESEARCH_2_STD_CASE_NOTES  where case_number__c= :bythis"
        parameters => { "bythis" => "casenumber"}
        target => "case_notes"

        cache_size => 10000
        tag_on_default_use => ["no_records_found_ESEARCH_2_STD_CASE_NOTES"]
        tag_on_failure => ["failure_occured_table_ESEARCH_2_STD_CASE_NOTES"]

 }

 jdbc_streaming {

        jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
        jdbc_user => "TLDLIC"
        jdbc_password => "TldLicspDev123"
        jdbc_validate_connection => true
        jdbc_driver_library => "./ojdbc6.jar"
        jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
        statement => "select * from ESEARCH_2_STD_CASE_DEFECTS where CASE__RCASENUMBER = :bythis3"
        parameters => { "bythis3" => "casenumber"}
        target => "case_defects"

        cache_size => 10000
        tag_on_default_use => ["no_records_found_ESEARCH_2_STD_CASE_DEFECTS"]
        tag_on_failure => ["failure_occured_table_ESEARCH_2_STD_CASE_DEFECTS"]


 }

  jdbc_streaming {

        jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
        jdbc_user => "TLDLIC"
        jdbc_password => "TldLicspDev123"
        jdbc_validate_connection => true
        jdbc_driver_library => "./ojdbc6.jar"
        jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
        # good
        statement => "select * from ESEARCH_2_STD_CASE_COMMENTS  where parentid = :bythis"
        parameters => { "bythis" => "casenumber"}
        target => "case_comment"

        cache_size => 10000
        tag_on_default_use => ["no_records_found_ESEARCH_2_STD_CASE_COMMENTS"]
        tag_on_failure => ["failure_occured_table_ESEARCH_2_STD_CASE_COMMENTS"]

 }



    jdbc_streaming {

        jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
        jdbc_user => "TLDLIC"
        jdbc_password => "TldLicspDev123"
        jdbc_validate_connection => true
        jdbc_driver_library => "./ojdbc6.jar"
        jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
        statement => "select * from ESEARCH_2_STD_CASE_ETRACK  where casenumber = :bythis"
        parameters => { "bythis" => "casenumber"}
        target => "case_ertack"

        cache_size => 10000
        tag_on_default_use => ["no_records_found_ESEARCH_2_STD_CASE_ETRACK"]
        tag_on_failure => ["failure_occured_table_ESEARCH_2_STD_CASE_ETRACK"]

 }


  jdbc_streaming {

        jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
        jdbc_user => "TLDLIC"
        jdbc_password => "TldLicspDev123"
        jdbc_validate_connection => true
        jdbc_driver_library => "./ojdbc6.jar"
        jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
        statement => "select * from ES_RMA_STD_RECORDS where CASE_NUMBER__R_CASENUMBER =  :caseNum"
        parameters => { "caseNum" => "casenumber"}
        target => "rma_case"

        cache_size => 10000
        tag_on_default_use => ["no_records_found_ES_RMA_STD_RECORDS"]
        tag_on_failure => ["failure_occured_table_ES_RMA_STD_RECORDS"]

 }


  jdbc_streaming {

        jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
        jdbc_user => "TLDLIC"
        jdbc_password => "TldLicspDev123"
        jdbc_validate_connection => true
        jdbc_driver_library => "./ojdbc6.jar"
        jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
        statement => "select * from ES_2_RMA_LINE_ITM_25FEB where  dbms_lob.substr( rma_c, 4000, 1 ) = :idVal"
        parameters => { "idVal" => "[rma_case][0][id]" }
        target => "rma_child"

        cache_size => 10000
        tag_on_default_use => ["no_records_found_ES_2_RMA_LINE_ITM_25FEB"]
        tag_on_failure => ["failure_occured_table_ES_2_RMA_LINE_ITM_25FEB"]

 }

   jdbc_streaming {

         jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
         jdbc_user => "TLDLIC"
         jdbc_password => "TldLicspDev123"
         jdbc_validate_connection => true
         jdbc_driver_library => "./ojdbc6.jar"
         jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
         statement => "select * from ESEARCH_2_STD_EMAIL_MSG_ALL where PARENT_CASENUMBER = :bythis6"
         parameters => { "bythis6" => "casenumber"}
         target => "email"

         cache_size => 10000
         tag_on_default_use => ["no_records_found_ESEARCH_2_STD_EMAIL_MSG_ALL"]
         tag_on_failure => ["failure_occured_table_ESEARCH_2_STD_EMAIL_MSG_ALL"]

  }

 mutate {
     copy => {
         "@timestamp" => "updateddatetime"

     }
     add_field => {
          "title" => "%{[case_details][0][Subject]}"
     }

     remove_field => ["@timestamp" , "@version", "[case_details][0][asset_appli_platform_model__c]"]


     rename => {
         "[case_details][0][resolution_details__c]" => "[case_details][0][Resolution]"
         "[case_details][0][casenumber]" => "[case_details][0][Case Number]"
         "[case_details][0][recordtype_name]" => "[case_details][0][Record Name]"
         "[case_details][0][id]" => "[case_details][0][Id]"
         "[case_details][0][contactemail]" => "[case_details][0][Contact Email]"
         "[case_details][0][subject]" => "[case_details][0][Subject]"


         "[case_details][0][account_owner_name]" => "[case_details][0][Account Owner Name]"
         "[case_details][0][severity__c]" => "[case_details][0][Severity]"
         "[case_details][0][alternate_phone__c]" => "[case_details][0][Alternate Phone No]"
         "[case_details][0][createddate]" => "[case_details][0][Create Date]"
         "[case_details][0][next_customer_contact__c]" => "[case_details][0][Next Customer Contact]"

         "[case_details][0][account_name]" => "[case_details][0][Account Name]"
         "[case_details][0][special_instructions__c]" => "[case_details][0][Special Instructions]"

         "[case_details][0][account_accountnumber]" => "[case_details][0][Account Number]"

        "[case_details][0][ownerid]" => "[case_details][0][Owner Id]"
        "[case_details][0][lastmodifieddate]" => "[case_details][0][Last Modified Date]"
        "[case_details][0][parent_casenumber]" => "[case_details][0][Parent Case Number]"

        "[case_details][0][asset_appliance_platform__c]" => "[case_details][0][Asset Appliance Platform]"

        "[case_details][0][asset_platform_version__c]" => "[case_details][0][Asset Platform Version]"
         "[case_details][0][origin]" => "[case_details][0][Origin]"
         "[case_details][0][symptoms__c]" => "[case_details][0][Symptoms]"
         "[case_details][0][owner_email]" => "[case_details][0][Owner Email]"
         "[case_details][0][description]" => "[case_details][0][Description]"
         "[case_details][0][status]" => "[case_details][0][Status]"


        "[case_details][0][closeddate]" => "[case_details][0][Closed Date]"
        "[case_details][0][resolution__c]" => "[case_details][0][Resolution]"
        "[case_details][0][product_version__c]" => "[case_details][0][Product Version]"

                 "[case_details][0][account_division_cbo__c]" => "[case_details][0][Account Division CBO]"
                 "[case_details][0][action_owner__c]" => "[case_details][0][Action Owner]"
                 "[case_details][0][alternate_contact_name__c]" => "[case_details][0][Alternate Contact Name]"
                 "[case_details][0][alternate_email__c]" => "[case_details][0][Alternate Email]"
                 "[case_details][0][cause_group__c]" => "[case_details][0][Cause Group]"
                 "[case_details][0][closure_code__c]" => "[case_details][0][Closure Code]"
                 "[case_details][0][contact_name__c]" => "[case_details][0][Contact Name]"
                 "[case_details][0][environment__c]" => "[case_details][0][Environment]"
                 "[case_details][0][last_response_date__c]" => "[case_details][0][Last Response Date]"
                 "[case_details][0][lastmodifiedbyemail]" => "[case_details][0][Last Modified By Email]"
                 "[case_details][0][platform__c]" => "[case_details][0][Platform]"
                 "[case_details][0][priority]" => "[case_details][0][Priority]"
                 "[case_details][0][product_ess__rname]" => "[case_details][0][Product ESS Name]"
                 "[case_details][0][root_cause__c]" => "[case_details][0][Root Cause]"
                 "[case_details][0][serial_number__c]" => "[case_details][0][Serial Number]"
                 "[case_details][0][type_of_case__c]" => "[case_details][0][Type Of Case]"
                 "[case_details][0][work_phone__c]" => "[case_details][0][Work Phone]"

                 "[case_defects][0][CASE__RCASENUMBER]" => "[case_defects][0][Case Number]"
                 "[case_defects][0][DEFECT_NUMBER__C]" => "[case_defects][0][Defect Number]"
                 "[case_defects][0][ENGINEERING_LINK__C]" => "[case_defects][0][Engineering Link]"
                 "[case_defects][0][SUBJECT__C]" => "[case_defects][0][Subject]"

                 "[case_notes][0][Case_Number__c]" => "[case_notes][0][Case Number]"
                 "[case_notes][0][CreatedDate]" => "[case_notes][0][Created Date]"
                 "[case_notes][0][Subject__c]" => "[case_notes][0][Subject]"

                 "[case_comment][0][COMMENTBODY]" => "[case_comment][0][Comment Body]"
                 "[case_comment][0][CREATEDDATE]" => "[case_comment][0][Created Date]"
                 "[case_comment][0][ISPUBLISHED]" => "[case_comment][0][Is Published]"
                 "[case_comment][0][PARENTID]" => "[case_comment][0][Parent Id]"
                 "[case_comment][0][CREATEDBY_EMAIL]" => "[case_comment][0][Created By Email]"

                 "[case_history][0][CREATEDBY_EMAIL]" => "[case_history][0][Created By Email]"
                 "[case_history][0][CREATEDDATE]" => "[case_history][0][Created Date]"
                 "[case_history][0][NEWVALUE]" => "[case_history][0][New Value]"
                 "[case_history][0][OLDVALUE]" => "[case_history][0][Old Value]"
                 "[case_history][0][CASEID]" => "[case_history][0][Case Id]"
                "[case_history][0][GROUP_C]" => "[case_history][0][Group]"

         }
 }
}

output {
    elasticsearch {

      hosts => "lnpvela04.ash.broadcom.net"
      #http_compression => true
      document_id => "%{casenumber}"
      index => "symantec_case_archival_v14_3_5"
 }
   #stdout { [case_history][0][CASEID] }


#C:\Users\anuryadav\Desktop\Working\log_file_conf_yml\symantec_v1.conf
}
