input {

## title 
## type
## updateddatetime
## source
## tags -> sorce, level 0 put anything.  
## dynamin case no in url
    jdbc {
        jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
        jdbc_user => "TLDLIC"
        jdbc_password => "TldLicspDev123"
        jdbc_validate_connection => true
        jdbc_driver_library => "C:/Users/anuryadav/Desktop/BroadcomFiles/logstash/v3/logstash-6.4.1/logstash-6.4.1/ojdbc6.jar"
        jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
        statement => "select distinct casenumber , concat('https://casupport-qa.broadcom.com/case/archived?source=symantec_alias&id=',casenumber) AS url from ESEARCH_CASE_REC_SYM_01_500"
        #rownum < 3
       #          statement => "select distinct casenumber , concat('https://casupport-qa.broadcom.com/case/archived?source=symantec_alias&id=',casenumber) AS url from ESEARCH_CASE_REC_SYM_01_500"

         
         add_field => { 			
			"source" => "Symantec Case Archive"
			"type" => "Archival Case"
		}
    #    add_tag => ["ESEARCH_CASE_REC_SYM_01_500"]
         tags => [ "ESEARCH_CASE_REC_SYM_01_500", "ESEARCH_CASE_HISTORY_SYM_500","ESEARCH_RELATED_CASE_SYM_500"  ,"ESEARCH_EMAIL_MESSAGE_SYM_500", "ESEARCH_CASE_COMMENTS_SYM_500"]
    }
}
filter {
		
		jdbc_streaming{
			jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
			jdbc_user => "TLDLIC"
			jdbc_password => "TldLicspDev123"
			jdbc_validate_connection => true
			jdbc_driver_library => "C:/Users/anuryadav/Desktop/BroadcomFiles/logstash/v3/logstash-6.4.1/logstash-6.4.1/ojdbc6.jar"
			jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
            statement => "select * from ESEARCH_CASE_REC_SYM_01_500 A inner join esearch_case_sub_desc_sym_500 B on a.casenumber = b.casenumber where a.casenumber= :bythis9"

            target => "case_details"
			parameters => { "bythis9" => "casenumber"}
            cache_size => 10000
            tag_on_default_use => ["no_records_found_ESEARCH_CASE_REC_SYM_01_500"]
            tag_on_failure => ["failure_occured_table_ESEARCH_CASE_REC_SYM_01_500"]
          
			
			
	}
		
 
 jdbc_streaming {
  
        jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
        jdbc_user => "TLDLIC"
        jdbc_password => "TldLicspDev123"
        jdbc_validate_connection => true
        jdbc_driver_library => "C:/Users/anuryadav/Desktop/BroadcomFiles/logstash/v3/logstash-6.4.1/logstash-6.4.1/ojdbc6.jar"
        jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
        statement => "select * from ESEARCH_CASE_HISTORY_SYM_500  where case_casenumber = :bythis2"
        parameters => { "bythis2" => "casenumber"}
        target => "case_history"         

        cache_size => 10000
        tag_on_default_use => ["no_records_found_ESEARCH_CASE_HISTORY_SYM_500"]
        tag_on_failure => ["failure_occured_table_ESEARCH_CASE_HISTORY_SYM_500"]        
    
 }

 jdbc_streaming {
  
        jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
        jdbc_user => "TLDLIC"
        jdbc_password => "TldLicspDev123"
        jdbc_validate_connection => true
        jdbc_driver_library => "C:/Users/anuryadav/Desktop/BroadcomFiles/logstash/v3/logstash-6.4.1/logstash-6.4.1/ojdbc6.jar"
        jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
        statement => "select * from ESEARCH_RELATED_CASE_SYM_500 where casenumber = :bythis3"
        parameters => { "bythis3" => "casenumber"}
        target => "related_case"
      
        cache_size => 10000
        tag_on_default_use => ["no_records_found_ESEARCH_RELATED_CASE_SYM_500"]
        tag_on_failure => ["failure_occured_table_ESEARCH_RELATED_CASE_SYM_500"]  
       
    
 }

  jdbc_streaming {
  
        jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
        jdbc_user => "TLDLIC"
        jdbc_password => "TldLicspDev123"
        jdbc_validate_connection => true
        jdbc_driver_library => "C:/Users/anuryadav/Desktop/BroadcomFiles/logstash/v3/logstash-6.4.1/logstash-6.4.1/ojdbc6.jar"
        jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
        statement => "select * from ESEARCH_CASE_COMMENTS_SYM_500  where parent_casenumber = :bythis"
        parameters => { "bythis" => "casenumber"}
        target => "case_comment"
        
        cache_size => 10000
        tag_on_default_use => ["no_records_found_ESEARCH_CASE_COMMENTS_SYM_500"]
        tag_on_failure => ["failure_occured_table_ESEARCH_CASE_COMMENTS_SYM_500"]  
    
 }
 
  jdbc_streaming {
  
        jdbc_connection_string => "jdbc:oracle:thin:@prodh-scan.ash.broadcom.net:1535:LRCSPDEV"
        jdbc_user => "TLDLIC"
        jdbc_password => "TldLicspDev123"
        jdbc_validate_connection => true
        jdbc_driver_library => "C:/Users/anuryadav/Desktop/BroadcomFiles/logstash/v3/logstash-6.4.1/logstash-6.4.1/ojdbc6.jar"
        jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
        statement => "select * from ESEARCH_EMAIL_MESSAGE_SYM_500 where PARENT_CASENUMBER = :bythis6"
        parameters => { "bythis6" => "casenumber"}
        target => "email"
        
        cache_size => 10000
        tag_on_default_use => ["no_records_found_ESEARCH_EMAIL_MESSAGE_SYM_500"]
        tag_on_failure => ["failure_occured_table_ESEARCH_EMAIL_MESSAGE_SYM_500"]  
    
 }


 mutate {
     copy => {
         "@timestamp" => "updateddatetime"
         
     }
     add_field => {
          "title" => "%{[case_details][0][Subject]}" 
     }

     remove_field => ["@timestamp" , "@version", "[case_details][0][asset_appli_platform_model__c]"]


     rename => { 
         "[case_details][0][resolution_details__c]" => "[case_details][0][Resolution]"
         "[case_details][0][casenumber]" => "[case_details][0][Case Number]"
         "[case_details][0][recordtype_name]" => "[case_details][0][Record Name]"
         "[case_details][0][id]" => "[case_details][0][Id]"
         "[case_details][0][contactemail]" => "[case_details][0][Contact Email]"
         "[case_details][0][subject]" => "[case_details][0][Subject]"

         "[case_details][0][type]" => "[case_details][0][Type]"
         "[case_details][0][account_owner_name]" => "[case_details][0][Account Owner Name]"
         "[case_details][0][severity__c]" => "[case_details][0][Severity]"
         "[case_details][0][alternate_phone__c]" => "[case_details][0][Alternate Phone No]"
         "[case_details][0][createddate]" => "[case_details][0][Create Date]"
         "[case_details][0][next_customer_contact__c]" => "[case_details][0][Next Customer Contact]"

         "[case_details][0][account_name]" => "[case_details][0][Account Name]"
         "[case_details][0][special_instructions__c]" => "[case_details][0][Special Instructions]"
         "[case_details][0][product__c]" => "[case_details][0][Product]"
         "[case_details][0][account_accountnumber]" => "[case_details][0][Account Number]"

        "[case_details][0][ownerid]" => "[case_details][0][Owner Id]"
        "[case_details][0][lastmodifieddate]" => "[case_details][0][Last Modified Date]"
        "[case_details][0][parent_casenumber]" => "[case_details][0][Parent Case Number]"
        "[case_details][0][lastmodifiedby_name]" => "[case_details][0][Last Modified By Name]"
        "[case_details][0][asset_appliance_platform__c]" => "[case_details][0][Asset Appliance Platform]"

        "[case_details][0][asset_platform_version__c]" => "[case_details][0][Asset Platform Version]"
         "[case_details][0][origin]" => "[case_details][0][Origin]"
         "[case_details][0][symptoms__c]" => "[case_details][0][Symptoms]"
         "[case_details][0][owner_email]" => "[case_details][0][Owner Email]"
         "[case_details][0][description]" => "[case_details][0][Description]"
         "[case_details][0][status]" => "[case_details][0][Status]"


        "[case_details][0][closeddate]" => "[case_details][0][Closed Date]"
        "[case_details][0][resolution__c]" => "[case_details][0][Resolution]"
        "[case_details][0][product_version__c]" => "[case_details][0][Product Version]"
        "[case_details][0][division]" => "[case_details][0][Division]"
     


         
         #   "[case_details][0][resolution_details__c]" => "[case_details][0][Resolution]"
         }
 }
}

output {
    elasticsearch {
      hosts => "lnpvela04.ash.broadcom.net"
      http_compression => true
      document_id => "%{casenumber}"
      index => "symantec_case_archival_v1"
 }
#   stdout { codec => rubydebug }
  

#C:\Users\anuryadav\Desktop\Working\log_file_conf_yml\symantec_v1.conf
}

